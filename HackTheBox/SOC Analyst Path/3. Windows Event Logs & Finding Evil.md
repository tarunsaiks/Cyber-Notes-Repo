```table-of-contents
```
# Windows Event Logging Basics

Windows Event Logs are intrinsic part of Windows OS, stores different components of the system including the system itself, applications running on it, ETW providers, services and others.

Windows event logging offers comprehensive logging capabilities for application errors, security events and diagnostic events. The default Windows event logs consist of `Application`, `Security`, `Setup`, `System`, and `Forwarded Events`.

![](../../Pasted%20image%2020250415200108.png)

It should be noted, that the Windows Event Viewer has the ability to open and display previously saved `.evtx` files, which can be then found in the "Saved Logs" section.

## The Anatomy of an Event Log

Application Logs - two levels of events -` Information` or `Error`

**Information** events provide general usage details about the application, such as its start or stop events. 
**Error** events highlight specific errors and often offer detailed insights into the encountered issues.
![](../../Pasted%20image%2020250415200321.png)

Each entry in the Windows Event Log is an "Event" and contains the following primary components:

- `Log Name`: The name of the event log (e.g., Application, System, Security, etc.).

- `Source`: The software that logged the event.

- `Event ID`: A unique identifier for the event.

- `Task Category`: This often contains a value or name that can help us understand the purpose or use of the event.

- `Level`: The severity of the event (Information, Warning, Error, Critical, and Verbose).

- `Keywords`: Keywords are flags that allow us to categorize events in ways beyond the other classification options. These are generally broad categories, such as "Audit Success" or "Audit Failure" in the Security log. This field is very useful when filtering event logs for specific types of events.

- `User`: The user account that was logged on when the event occurred.

- `OpCode`: This field can identify the specific operation that the event reports.

- `Logged`: The date and time when the event was logged.

- `Computer`: The name of the computer where the event occurred.

- `XML Data`: All the above information is also included in an XML format along with additional event data.

The `Event ID` in the top left corner serves as a unique identifier, which can be further researched on Microsoft's website to gather additional information. The "**SideBySide**" label next to the event ID represents the event source. Below, we find the general error description, often containing rich details. By clicking on the details, we can further analyze the event's impact using XML or a well-formatted view.

![](../../Pasted%20image%2020250415200244.png)

Additionally, we can extract supplementary information from the event log, such as the process ID where the error occurred, enabling more precise analysis.

![](../../Pasted%20image%2020250415200524.png)
Few of the crucial details we can find on this event viewer are:
- This event 4625 - signifies a creation of logon session on the destination machine, originating from the accessed computer where the session was established.
- We also find **Logon ID** which allows us to correlate this logon with any other events with same ID.
- **Logon Type** is indicating 5, which according to [Microsoft Documentation]([Administrative tools and logon types reference - Windows Server | Microsoft Learn](https://learn.microsoft.com/en-us/windows-server/identity/securing-privileged-access/reference-tools-logon-types)), refers to `Service Logon` --> `SYSTEM` initiated the service.
- ![Windows Logon Type 5 - Service Logon](../../Pasted%20image%2020250415200939.png)

## Leveraging Custom XML Queries

We can also create custom XML Queries to identify related events like say using Logon ID. 

Filter Current Log -> XML -> Edit Query Manually

![](../../Pasted%20image%2020250415201631.png)SubjectLogonId --> Logon ID

```XML
<QueryList>
	 <Query Id="0" Path="Security">
		<Select Path="Security"> *[EventData[Data[@Name='SubjectLogonId']='0x3E7']]
		</Select>
	</Query>
</QueryList>
```

For further guidance, Microsoft offers informative articles on¬†[advanced XML filtering in the Windows Event Viewer](https://techcommunity.microsoft.com/t5/ask-the-directory-services-team/advanced-xml-filtering-in-the-windows-event-viewer/ba-p/399761). By constructing such customized XML Queries, we can narrow down our focus to responsible logs and accounts.


> [!Important]SYSTEM account a.k.a SubjectLogonId=0x3E7
> `SubjectLogonId = 0x3E7` in decimal is 999 --> This refers to `SYSTEM` account, which is highest-privileged account used by Windows OS to perform system-level tasks.


Delving into the log details progressively reveals a narrative. For instance, the analysis begins with¬†[**Event ID 4907**](https://docs.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4907), which signifies an **audit policy change**. Within the¬†[event description](https://learn.microsoft.com/en-us/windows/security/threat-protection/auditing/event-4907), we find valuable insights, such as "This event generates when the SACL of an object (for example, a registry key or file) was changed."

If you‚Äôre not familiar with what a **SACL** is, you can learn more by visiting this [link about Access Control Lists (ACLs)](https://docs.microsoft.com/en-us/windows/win32/secauthz/access-control-lists).

The **"S" in SACL stands for System Access Control List**. It's used by system administrators to **track and log who tries to access protected files or resources** on a system.

Each entry in a SACL (called an **Access Control Entry** or **ACE**) tells the system **what kind of access attempts (like read, write, delete)** should be logged, and **who those rules apply to**.

SACLs can be set to create logs for:

- **Failed access attempts**
- **Successful access attempts**
- **Or both**

These logs are saved in the **security event log**, so administrators can review them later. So basically, a SACL is like a **security camera for your files**‚Äîit doesn‚Äôt stop people from getting in, but it **records the attempts** based on rules set by the admin, and logs them in the **security event log** for review.

To learn more, check out the section on ¬†[Audit Generation](https://learn.microsoft.com/en-us/windows/win32/secauthz/audit-generation)¬†and¬†[SACL Access Right](https://learn.microsoft.com/en-us/windows/win32/secauthz/sacl-access-right) in the documentation.

While I was struggling to understand what the above two screenshots signify and investigate, my good old friend ChatGPT, just helped me understand it even better.

#### ChatGPT version of Investigation
You're looking at **Event ID 4907**, which means **‚ÄúAuditing settings on object were changed.‚Äù** This is part of Windows Security Auditing and specifically relates to **changes in SACL (System Access Control List)**.

Let's break this down:

---

### üìå **Event Summary**

- **Event ID:** 4907
- **Event Type:** Success Audit
- **Category:** Audit Policy Change
- **Description:** Some process changed the **auditing rules** (SACL) on a file.

---

### üîê **What Happened?**

Windows detected that **auditing settings (SACL)** were changed on a file.

- **ObjectName:**  
    `C:\$WINDOWS.~BT\NewOS\Windows\System32\Recovery\...bootmgfw.efi`  
    This is a **UEFI boot manager file**, typically accessed during Windows upgrades or system recovery.
    

---

### üßæ **Key Fields Explained**

|Field|Meaning|
|---|---|
|**Security ID:** SYSTEM|Indicates the SYSTEM account made the change (most privileged local account).|
|**Logon ID:** `0x3E7`|Confirms the action was taken by the SYSTEM account (as discussed before).|
|**Process Name:** `C:\$WINDOWS.~BT\Sources\SetupHost.exe`|This is a Windows Setup process, likely part of a Windows update or installation.|
|**SubjectUserName:** ARASHPARSA2BB9$|The machine account name ‚Äî not a user. The `$` at the end confirms it's a computer account.|


### üß† In Simple Terms

Windows setup (SetupHost.exe) ‚Äî running as SYSTEM ‚Äî **changed the auditing settings** on a critical system boot file during a Windows update or recovery setup. The event was logged because changes to what is being audited (e.g., read/write access to that file) can be important from a **forensics or security** perspective.

This is a **normal event during system upgrades or Windows installation**, especially when `SetupHost.exe` is involved
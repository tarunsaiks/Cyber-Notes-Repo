# Indicators of Compromise (IoC)

Indicators of Compromise, also referred to as IOCs are **a method of information sharing, so that organisations can determine whether they have come into contact with similar attacks.** These are some examples of common IOCs:

- **IP Addresses –** If an IP is behaving maliciously, it can be considered an IOC. **Example**: If Organisation A is suffering from a distributed denial-of service attack by 5 IPs, they could tell Organisation B to look out for the 5 IPs that are attacking them, and they are now considered indicators of compromise. This means Org B can setup alerts for these IPs, so if they attempt to do the same thing they can immediately block them if needed.

- **Email Addresses –** If an email address is sending out malicious emails, it can be considered an IOC. **Example:** Organisation A is targeted by a phishing campaign from the email address _purelyanexample@googlemail.com_. Org A can share this with other organisations, and tell them to be on the lookout for emails coming from this sender.

- **File Sizes Value –** It’s pretty unlikely that a large number of files will have the exact same number of bytes. If we have a piece of malware, we can see the file size, and use this as an indicator to then search through all files, looking for ones that match.

- **MD5/SHA-1 Hashes –** Hashing is a one-way cryptographic function that allows us to create a signature represented by a string value, known as a checksum. If the file is modified in any way, the hash value will be completely different. So if we have two identical files on a system, and we know the hash of one, we can find the other using this value as an IOC.

- **Strings –** We can retrieve strings from a file, and use them as an IOC for searching. In the below example, I have used the command `**strings**` on a random .exe file, which will output all human-readable strings to the terminal. When selecting an appropriate strings IOC we want something that is not common, otherwise we will detect too many false positives when searching. An example would be a piece of malware that contains the string “0wNeD BY #Lun4rSqUAD”, in this case we would use “Lun4rSqUAD” as a string-based IOC, as it is extremely unique.

## **Retrieving File Size Property**

There are two ways we can get a file’s size; using the GUI, or using the command-line. To do it within Kali you can simply navigate to the directory where the file is stored, find the file and: **right-click > properties > size value**.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/1b529039fb612a337702cf81427a8edeb1103811bb3c7f54a259acef22c247aa4e995393972d255010e63df06933.png)

To find a file’s size via the linux command-line we will navigate to the directory where the file is, and use the command `ls -lh` which will list all files and their sizes. In this case after “root root” we see the number “349”, which represents 349 bytes, the same value as shown above via the file properties tab.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/082a960b2fea72b08aac0cad2ba4dca662e281d249c54166ff57f49a5be1b37e7be836de8648ef695d90ce0f3be9.png)

Let's cover how to do this on Windows with another files. We can simply right-click the file and go to Properties:

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/140ecf22561cf849420c21bdfbac0c09e3fdc744c4bbe28ef1b8ac6ae9b7405ce88be6ffaede2c9638c747d9b45a.PNG)

## **Retrieving File Name Property**

This is the easiest IOC to collect, as we can simply read the file’s name below the icon, view it via the properties pane (**right-click > properties > Name value**), or by listing the contents of the file’s directory.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/76539b77dd80ca1487818c5e1a83da12515877182fa9863f75b9a2dcf9dbccd0cde6d0cc48b9d400be041cac27ee.png)

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/ef868a3b739efebaab70526992744a928d26e77e64fb49abf203ccb751dddb4e3f27c927744e539b48dd6f321b25.png)

This is the same for files on a Windows-based system, where we will right-click it, go to Properties, and copy the filename:

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/7fbcfedacd9b0eedc789ef68b2a1ebe81588ef86fc8ceed2431d3e43e46e42984bd4066690a2a3f51987b2fa9d9b.PNG)

Great! These are some pretty basic indicators, but they are still useful regardless. We'll explore two other indicators next, called ‘hashes’ and ‘strings’.

# Generating File Hash indicators

**But first, what are hashes?** #hash #hashes

A hash is a unique string value that corresponds to the contents of the file. They are generated by hashing algorithms, such as Message Digest 5 (MD5) or Secure Hash Algorithm 256 (SHA256). If two files are exactly the same, the hash will match. But if even one character is different, the files will have unique hash values (we'll show you this in a second!).

## **Generating a MD5 Checksum**
#md5 #checksum
In the below example we create a md5 checksum of the file **TextFile2.txt** on a Linux-based system using the command `**md5sum TextFile2.txt**`, giving us the hash **5d363d305385b3a71ca7eed28eb2c209**.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/be32fbb5eaacb14c37255d4af5ae4fe310616f5ed326de2d6a255a384a2c2d64896ffb8c134e97801aaf1c3f8beb.png)

Then we edit the file and change the first line, adding another “!” to the end. After generating a hash value, we can see the value is now completely different!

- Previously: **5d363d305385b3a71ca7eed28eb2c209**
- Now: **584cce49f570c0e4578d22e431e5e4aa**

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/468745f15274a44a883ec3567fb2c232fb5a33099fa7535810804fc5c9296ef8e585e3cc1c5249daabf41cace084.png)

We use the same command to use other hashing algorithms, such as the industry standard, SHA256. Simply replace the command md5sum with `**sha256sum**` `**(filename)**`!

It's worth noting that MD5 hashes are not as commonly used nowadays due to the chance for hash collisions, meaning two files _could_ provide the same hash.

Now let's go over how to retrieve file hashes in Windows! Open a PowerShell terminal, move into the same location as the file you want to retrieve the hash for, and use the command `**Get-FileHash <filename>**`. By default, the hashing algorithm will be SHA256. But we can use the `**-algorithm**` flag to specify what algorithm we want to use, such as MD5 or SHA1.

![](https://d2y9h8w1ydnujs.cloudfront.net/uploads/content/images/5cecdcedf5cfca556e54385b455f987e1b02ddc735ef37a1fd56bc94019ed46c080df5f08aca99256bc8d8fcf52d.PNG)